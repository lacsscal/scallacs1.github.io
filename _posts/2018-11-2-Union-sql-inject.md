---> "熟悉一下格式。”##前言：归档#union 联合查询注入##学习过程参照《Web 安全攻防》---以下为部分学习中的 困惑和心得（未仔细整理，稍见凌乱） 使用**sql-lab**作为学习事件环境（在环境搭建过程中掉了不少坑（是我太菜））---##<h2 id="正文">正文</h2>	<?php	//including the Mysql connect parameters.	include("../sql-connections/sql-connect.php");	1    error_reporting(0);	// take the variables 	if(isset($_GET['id']))	{	$id=$_GET['id'];	//logging the connection parameters to a file for analysis.		$fp=fopen('result.txt','a');	fwrite($fp,'ID:'.$id."\n");	fclose($fp);		// connectivity $sql="SELECT * FROM users WHERE id='$id' LIMIT 0,1";echo "your sql statement is ".$sql."<br>"; $result=mysql_query($sql);//执行一条sql查询，值存入结果集$row = mysql_fetch_array($result);//从结果集中取一行做。。。//只调用一次，而mysql_feach_array()函数从结果取得一行做关联组，或数字组，或二者兼有返回根据从结果取得的行生成的数组，若没有更多行则返回false	if($row)	{  	echo "<font size='5' color= '#99FF00'>";//定义显示的格式  	echo 'Your Login name:'. $row['username'];  	echo "<br>";  	echo 'Your Password:' .$row['password'];  	echo "</font>";  	}	else 	{	echo '<font color= "#FFFF00">';//失败时的格式	print_r(mysql_error());	echo "</font>";  	}}	else { echo "Please input the ID as parameter with numeric value";}?>Sql1 less1 php代码分析1:error_reporting() 函数规定报告哪个错误。该函数设置当前脚本的错误报告级别。该函数返回旧的错误报告级别。语法error_reporting(report_level) 2$_GET 变量用于收集来自 method="get" 的表单中的值。通过_GET获得参数xss_input_value]的值echo输出一个<input>标签，将xss_input_value的值放入input标签的value中3isset() 函数用于检测变量是否已设置并且非 NULL。是则返回false4让第一行查询的结果是空集（即union左边的select子句查询结果为空），那么我们union右边的查询结果自然就成为了第一行，就打印在网页上了，这个id他一般传的是数字，而且一般都是从1开始自增的，我们可以把id值设为非正数（负数或0），浮点数，字符型或字符串都行。5正式查询数据库的各种信息在Less1 我们可以看见仅有2,3列被显示在了网页上所以我们就只能用2,3这个位置了，但是两个位置应该是不够用的，这时我们就用到数据库的连接函数了，常用的就concat和concat_ws,其中concat_ws的第一个参数是连接字符串的分隔符，还会用到group__concat(可以把查询出来的多行连接起来)查库名此时可以尝试在2的位置查询当前数据库名：：直接使用datebase()函数代替2： concat_ws(char(32,58,32),user(),database(),version())http://127.0.0.1/sql1/Less-1/?id=-1%27%20union%20select%201,2,concat_ws(char(32,58,32),user(),database(),version())%23利用第三项，把第三项的位置换成 。以上。以下。user():返回当前数据库连接使用的用户database():返回当前数据库连接使用的数据库version():返回当前数据库的版本这三项连接起来，一条回显。6查询数据库security中有哪些表首先说一下mysql的数据库information_schema，他是系统数据库，安装完就有，记录是当前数据库的数据库，表，列，用户权限等信息，下面说一下常用的几个表SCHEMATA表:储存mysql所有数据库的基本信息，包括数据库名，编码类型路径等，show databases的结果取之此表。TABLES表:储存mysql中的表信息，（当然也有数据库名这一列，这样才能找到哪个数据库有哪些表嘛）包括这个表是基本表还是系统表，数据库的引擎是什么，表有多少行，创建时间，最后更新时间等。show tables from schemaname的结果取之此表COLUMNS表：提供了表中的列信息，（当然也有数据库名和表名称这两列）详细表述了某张表的所有列以及每个列的信息，包括该列是那个表中的第几列，列的数据类型，列的编码类型，列的权限，猎德注释等。是show columns from schemaname.tablename的结果取之此表。 查表名   得知数据库库名后，输入以下命令来查询表名Select table_name from information_schema.tables where table_schema='sql' limit 0,1Ps: 记得把引号中的sql 改为之前所查询到的数据库名用此句代替2的位置，并加上括号此时，页面会返回数据库的第一个表名修改limit中的第一位数字 用 limit1,1即可获取数据库的第二个表名7现在数据库名与表名查询完毕，接下来查询字段名查询语句如下：select column_name from information_schema.columns where table_schema='sql' and table_name='emils' limit 0,1同样把此语句放在字段二位置8当获取了库名，表名，字段名，就可以构造SQL语句查询数据库的数据如下 查询字段email_id对应的数据，构造SQL语句如下所示select email_id from sql.emails limit0,1目前不知道错误在哪里，待修正总结整理为一句：union select 1,2,concat_ws(char(32,58,32),id,database(),password) from users limit 1,19总结分析	<?php	$con=mysqli_connect("localhost","root","123456","test");	// 检测连接	if (mysqli_connect_errno())	{		echo "连接失败: " . mysqli_connect_error();	}		$id = $_GET['id'];		$result = mysqli_query($con,"select * from users where `id`=".$id);		while($row = mysqli_fetch_array($result))	{		echo $row['username'] . " " . $row['address'];		echo "<br>";	}	?>union注入代码分析